# =====================================================
# Railway Production Profile Configuration
# =====================================================

# Database Configuration - Railway MySQL
spring.datasource.url=jdbc:mysql://${RAILWAY_DB_HOST:127.0.0.1}:${RAILWAY_DB_PORT:3306}/${RAILWAY_DB_NAME:railway}?useSSL=${RAILWAY_DB_SSL:false}&allowPublicKeyRetrieval=true&serverTimezone=UTC&characterEncoding=UTF-8
spring.datasource.username=${RAILWAY_DB_USERNAME:root}
spring.datasource.password=${RAILWAY_DB_PASSWORD:}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# Connection Pool Configuration (Production optimized)
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1200000

# JPA / Hibernate Configuration
spring.jpa.database-platform=org.hibernate.dialect.MySQL8Dialect
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false

# Flyway Database Migrations - ENABLED FOR PRODUCTION
spring.flyway.enabled=true
spring.flyway.baseline-on-migrate=true
spring.flyway.schemas=leetquery

# SQL Initialization
spring.sql.init.mode=never
spring.sql.init.continue-on-error=false

# Server Configuration
server.port=${PORT:8080}
server.servlet.context-path=/api

# Logging Configuration (Production levels)
logging.level.root=WARN
logging.level.com.leetquery=INFO
logging.level.com.leetquery.backend.filter=INFO
logging.level.com.leetquery.backend.exception=WARN
logging.level.org.springframework=WARN
logging.level.org.springframework.web=INFO
logging.level.org.springframework.security=WARN
logging.level.org.springframework.jdbc=INFO
logging.level.org.hibernate.SQL=WARN

# File logging
logging.file.name=logs/leetquery-production.log
logging.file.max-size=50MB
logging.file.max-history=30

# Connection timeout settings
server.tomcat.connection-timeout=30000
server.servlet.session.timeout=3600
server.tomcat.max-http-post-size=10485760

# Error Handling
server.error.include-message=always
server.error.include-binding-errors=always

# Performance Tuning
server.compression.enabled=true
server.compression.min-response-size=1024
server.tomcat.threads.max=200
server.tomcat.threads.min-spare=10

# Security
server.servlet.session.cookie.secure=false
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.same-site=lax
